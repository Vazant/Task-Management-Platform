<div class="forgot-password-container">
  <mat-card class="forgot-password-card">
    <mat-card-header>
      <mat-card-title>Восстановление пароля</mat-card-title>
      <mat-card-subtitle>TaskBoard Pro</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <p *ngIf="!emailSent">
        Введите ваш email, и мы отправим инструкции по восстановлению пароля
      </p>

      <p *ngIf="emailSent" class="success-message">
        Инструкции отправлены на ваш email
      </p>

      <div *ngIf="!emailSent">
        <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="forgot-password-form">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input
              matInput
              type="email"
              formControlName="email"
              placeholder="Введите ваш email"
              autocomplete="email">
            <i-lucide class="icon-center" [img]="Mail"></i-lucide>
            <mat-error *ngIf="isFieldInvalid('email')">
              {{ getErrorMessage('email') }}
            </mat-error>
          </mat-form-field>

          <div class="error-message" *ngIf="error$ | async as error">
            <mat-error>{{ error }}</mat-error>
          </div>

          <button
            mat-raised-button
            color="primary"
            type="submit"
            class="submit-button"
            [disabled]="forgotPasswordForm.invalid || (loading$ | async)">
            <i-lucide
              class="icon-center"
              [img]="Loader2"
              [size]="20"
              *ngIf="loading$ | async">
            </i-lucide>
            <span *ngIf="(loading$ | async) === false">Отправить инструкции</span>
          </button>
        </form>
      </div>

      <div *ngIf="emailSent" class="success-content">
        <i-lucide class="icon-center" [img]="CheckCircle"></i-lucide>
        <p>Проверьте ваш email и следуйте инструкциям для восстановления пароля</p>
        <button mat-button (click)="resetForm()" class="back-button">
          Вернуться к форме
        </button>
      </div>
    </mat-card-content>

    <mat-card-actions>
      <a mat-button routerLink="/auth/login">Вернуться к входу</a>
    </mat-card-actions>
  </mat-card>
</div>
